//@ui5-bundle com/dhi/cms/cmsrequester/Component-preload.js
sap.ui.predefine("com/dhi/cms/cmsrequester/Component", ["sap/ui/core/UIComponent","com/dhi/cms/cmsrequester/model/models"],(e,t)=>{"use strict";return e.extend("com.dhi.cms.cmsrequester.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("com.dhi.cms.cmsrequester.controller.App",{onInit(){}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/controller/BaseController", ["sap/ui/core/mvc/Controller","sap/m/Link","sap/ui/core/Fragment","sap/m/MessageBox"],function(e,t,n,o){"use strict";return e.extend("com.dhi.cms.cmsrequester.controller.BaseController",{getRouter:function(){return this.getOwnerComponent().getRouter()},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},_getFragmentId:function(e,t,n){return e+`---${t}--${n}`},onNavigation:function(e){var t=this.getOwnerComponent().getRouter();var e;if(e){t.navTo(e)}else{console.error("Navigation target not defined.")}},confirmAction:function(e,t){let n=new Promise((n,i)=>{let r=[o.Action.YES,o.Action.NO];if(t){r=t}o.confirm(e,{actions:r,emphasizedAction:o.Action.YES,onClose:e=>{if(e===o.Action.YES){n(e)}},dependentOn:this.getView()})});return n},getBusyDialog:function(){if(!this._oBusyDialog){this._oBusyDialog=sap.ui.xmlfragment(this.getView().getController().createId("busyDialogId"),"com.dhi.cms.cmsrequester.fragments.BusyDialog",this);this.getView().addDependent(this._oBusyDialog)}return this._oBusyDialog},getAppModulePathBaseURL:function(){var e=this.getOwnerComponent().getManifestEntry("/sap.app/id");var t=e.replaceAll(".","/");var n=jQuery.sap.getModulePath(t);return n},getText:function(e,t){let n=this.getResourceBundle();return n.getText(e,t)},ODataPost:function(e,t){return new Promise((n,o)=>{let i=this.getView().getModel();let r=i.bindList(e);let s=r.create(t);s.created().then(()=>{try{let e=s.getObject();console.log("New entity created:",e);if(e&&e.ID){console.log("New ID:",e);n(e.ID)}else{o("No ID returned from backend")}}catch(e){o(e)}}).catch(e=>{console.error("Create failed:",e);o(e)})})},_getfiledata:async function(e){let t={};t.file_name=e.getFileName();let n=await this.getBase64(e._oFileObject);t.media_type=this.getFileType(n.split(",")[0]);t.file_content=n.split(",")[1];return t},getBase64:function(e){return new Promise((t,n)=>{var o=new FileReader;o.readAsDataURL(e);o.onload=function(){t(o.result)}})},deleteFile:function(e){return e.delete()},getFileType:function(e){const t=/data:([^;]+);base64/;const n=e.match(t);if(n){return n[1]}else{return"unknown"}},_getCombovalues:async function(e){let t=this.getModel();let n="/Attributes('"+e+"')";let o=t.bindContext(n,undefined,{$expand:"combovalues"});let i=await o.requestObject().then(function(e){console.log(e);return e});return i}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/controller/ContractDetails.controller", ["./BaseController","sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/MessageToast","com/dhi/cms/cmsrequester/util/transaction/ContractManager","sap/ui/core/Messaging","sap/ui/core/message/Message","sap/ui/core/message/MessageType","sap/ui/core/BusyIndicator"],(t,e,a,o,i,r,n,s,c)=>{"use strict";return t.extend("com.dhi.cms.cmsrequester.controller.ContractDetails",{onInit(){this.getRouter().getRoute("ContractDetails").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(t){c.show(0);this.basicVaditionIds=["contractTitleInput","contractTypeSelect","contractaliasInput","contractdescriptionInput"];this.clearValidationStates(this.basicVaditionIds);this._SelectedContractType;const e=t.getParameter("arguments");this.contractId=e.contractId;const a=t.getParameter("name");const o=!!this.contractId;this._oIconTabBar=this.byId("iconTabBar");if(!this.contractId){this._initializeContractMasters()}else{this._getContractDetails()}this._focusOnBasicInfoTab();const i=this.getView();i.setModel(r.getMessageModel(),"message");r.removeAllMessages();c.hide()},_initializeContractMasters:function(){const t={ID:null,alias:null,contract_id:null,description:null,end_date:null,is_visible:true,name:null,start_date:null,templates_ID:null,attribute_values:[],attachments:[]};this.getModel("contractModel").setData(t)},_getContractDetails:async function(){let t=this.getModel();let e="/Contracts('"+this.contractId+"')";let a=t.bindContext(e,undefined,{$expand:"attribute_values,attachments"});let o=await a.requestObject().then(function(t){console.log(t);return t});this.contractData=o;this.getModel("contractModel").setData(o);this.getModel("appModel").setProperty("/status",o.status)},_focusOnBasicInfoTab:function(){const t=this.byId("iconTabBar");t.setSelectedKey("BasicInfo");const e=t.getItems()[0].getDomRef();if(e){e.focus()}this._currentTabKey="BasicInfo"},onTabSelect:function(t){let e=this.byId("iconTabBar").getSelectedKey();if(t){e=t}let o=this.byId("contractTypeSelect").getSelectedKey();if(!this.byId("contractTypeSelect").getSelectedKey()){this.byId("iconTabBar").setSelectedKey("BasicInfo");a.warning("Please select the Contract Type");return false}if(e!="BasicInfo"){if(this._SelectedContractType!=o){this.initializeDetails()}}if(e!="Details"){this._setDefaultFirstDetailsSectionTab()}this._SelectedContractType=o;return true},handleNextTabpress:function(t){if(this.onTabSelect(t)){this._oIconTabBar.setSelectedKey(t)}},_setDefaultFirstDetailsSectionTab:function(){var t=this.byId("idSpecificationBox");var e=this.getView().getModel("Details").getProperty("/AttributeGroups");if(e&&e.length>0){t.setSelectedKey(e[0].Attribute_Groups_ID)}},initializeDetails:function(){this.getBusyDialog().open();this.getBusyDialog().setText("...loading Basic Information.");const t=this.getOwnerComponent().getModel();let e=this.byId("contractTypeSelect").getSelectedKey();const a=this;const o=`/TemplatePortalCatalogue(TemplateID='${e}')`;const i=t.bindContext(o);const r=i.getBoundContext();this.productSpecificationBinding=t.bindList("Set",r,[],[],{$$ownRequest:true});this.model=t;this.isBound=true;return this.productSpecificationBinding.requestContexts(0,100).then(async function(t){const e=t.map(function(t){return t.getObject()});const o={};for(const t of e){const e=t.Attribute_Groups_ID||"defaultGroup";let i;if(!o[e]){o[e]={Attribute_Groups_ID:e,Attribute_Group_Name:t.Attribute_Group_Name||"Group",Attribute_Group_Role:t.Attribute_Group_Role||"",AttributeGroupOrder:t.AttributeGroupOrder||0,Attributes:[]}}let r=t.Attribute_Value||"";if(t.AttributeType.toLowerCase()==="date"){r=a._formateDateToDateValueFormat(r,t.AttributeType)}if(t.AttributeType==="select"){i=await a._getCombovalues(t.Attribute_ID);i=i.combovalues}if(a.contractId){if(a.contractData&&a.contractData.attribute_values){const e=a.contractData.attribute_values.find(e=>e.attribute_groups_ID===t.Attribute_Groups_ID&&e.attributes_ID===t.Attribute_ID);if(e){r=e.valueJson||""}if(t.AttributeType.toLowerCase()==="date"){r=a._formateDateToDateValueFormat(r,t.AttributeType)}}}const n={Attribute_ID:t.Attribute_ID,Attribute_Name:t.Attribute_Name,AttributeOrder:t.AttributeOrder||0,IsMandatory:!!t.Is_Required,AttributeType:t.AttributeType||"String",AttributeTypeAssociation:i||[],Value:r,IsPortalEnabled:typeof t.IsPortalEnabled!=="undefined"?t.IsPortalEnabled:null,Portal_ID:t.Portal_ID||null};o[e].Attributes.push(n)}let i=Object.keys(o).map(function(t){return o[t]});i.sort(function(t,e){return t.AttributeGroupOrder-e.AttributeGroupOrder});i.forEach(function(t){t.Attributes.sort(function(t,e){return t.AttributeOrder-e.AttributeOrder})});const r={AttributeGroups:i};a.getOwnerComponent().getModel("Details").setData(r);console.log("Details",a.getOwnerComponent().getModel("Details").getData());a.getBusyDialog().close();return r}).catch(function(t){jQuery.sap.log.error("Failed to load TemplatePortalCatalogue Set",t);throw t})},_formateDateToDateValueFormat:function(t,e){if(typeof t==="string"&&t.trim()!==""&&e&&e.toLowerCase()==="date"){const e=new Date(t);if(!isNaN(e.getTime())){t=e}else{console.warn("Invalid date format:",t);t=null}}else if(t===""){t=null}return t},onNavigation:function(t){var e=this.getOwnerComponent().getRouter();var t;if(t){e.navTo(t)}else{console.error("Navigation target not defined.")}},handleSaveContractDetails:function(){console.log(this.getView().getModel("Details").getData())},formatDate:function(t){if(!t){return""}try{var e=new Date(t);if(isNaN(e.getTime())){return t}var a=function(t){return t<10?"0"+t:t};return e.getFullYear()+"-"+a(e.getMonth()+1)+"-"+a(e.getDate())}catch(e){return t}},formatAttribute:function(t,e){if(t===null||typeof t==="undefined"||t===""){return""}if(e==="CheckBox"){if(t===true||t==="true"||t==="1"||t===1){return"Yes"}return"No"}if(e==="DatePicker"){return this.formatDate(t)}if(e==="MultiInput"){if(Array.isArray(t)){return t.join(", ")}return String(t)}return String(t)},onUploadCompleted:async function(t){let e=t.getParameters().item;let a=this.getModel("contractModel").getProperty("/attachments")||[];let o=Array.isArray(e)?e:[e];let i=this;const r=await Promise.all(o.map(async function(t){return await i._getfiledata(t)}));a.push(...r);this.getModel("contractModel").setProperty("/attachments",a);console.log("Mapped upload results:",a)},onBeforeUploadStarts:function(t){debugger},handleSaveandSubmitContractDetails:async function(t){const e=this.getModel("contractModel").getData();if(t==="save"){if(!this.validateControls(this.basicVaditionIds)){o.show("Please fill all mandatory fields.");return}}else{e.status="Submitted"}e.attribute_values=this.convertModelDataToAttributeValues();if(t==="save"){e.status="Draft"}else{e.status="Submitted"}let i=this;if(!this.contractId){try{const t=await this.ODataPost("/Contracts",e);if(t){o.show("Contract Submitted Successfully.");this.getRouter().navTo("Contracts")}}catch(t){console.error("Create failed:",t);o.show("Contract creation failed")}}else{console.log(this.getAppModulePathBaseURL());$.ajax({url:this.getAppModulePathBaseURL()+"/contracts/Contracts('"+this.contractId+"')",method:"PUT",contentType:"application/json",data:JSON.stringify(e),success:function(t){console.log(t);a.success("Contract Submitted Successfully.",{actions:[a.Action.OK],onClose:function(t){if(t===a.Action.OK){i.getRouter().navTo("Contracts")}}})},error:function(t){o.show("Error submitting data")}})}},convertModelDataToAttributeValues:function(){const t=this.getModel("Details").getData();const e=[];if(!t||!Array.isArray(t.AttributeGroups))return e;t.AttributeGroups.forEach(t=>{const a=t.Attribute_Groups_ID;(t.Attributes||[]).forEach(t=>{let o=typeof t.Value!=="undefined"&&t.Value!==null?t.Value:"";if(t.AttributeType==="boolean"){o=String(o)}let i=o;e.push({attribute_groups_ID:a,attributes_ID:t.Attribute_ID,valueJson:i})})});return e},validateControls:function(t){let e=true;t.forEach(t=>{const a=this.byId(t);if(!a){console.warn("Control not found:",t);return}let o=null;if(a.getValue){o=a.getValue()}else if(a.getSelectedKey){o=a.getSelectedKey()}else if(a.getDateValue){o=a.getDateValue()}else if(a.getSelected){o=a.getSelected()}if(typeof o==="string"){o=o.trim()}const i=o===null||o===""||o===undefined;if(i){e=false;a.setValueState("Error");a.setValueStateText("This field is required.")}else{a.setValueState("None")}});return e},clearValidationStates:function(t){t.forEach(t=>{const e=this.byId(t);if(!e)return;if(e.setValueState){e.setValueState("None");e.setValueStateText("")}})}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/controller/Contracts.controller", ["./BaseController","sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/MessageToast","sap/ui/table/TablePersoController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/ui/core/Fragment","sap/ui/export/Spreadsheet","sap/ui/export/library","sap/ui/core/BusyIndicator"],(e,t,r,o,s,n,a,l,i,c,u,d)=>{"use strict";var p=u.EdmType;return e.extend("com.dhi.cms.cmsrequester.controller.Contracts",{onInit(){this.getRouter().getRoute("Contracts").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){this._refreshTable();this._setPersonalization();this.clearAllFilters()},onGoBtnPress:function(e){let t=this.byId("idFilterBar");let r=t.getAllFilterItems();let s=[];r.forEach(e=>{let t=e.getName();let r;if(t==="contract_id"){let r=e.getControl().getValue();if(r){s.push(new n(t,"Contains",r))}}else{r=e.getControl().getSelectedKeys();if(r){r.forEach(e=>{s.push(new n(t,"EQ",e))})}}});let a=this.byId("tblContracts");let l=a.getBinding("rows");l.filter(s);o.show("Filters Applied Sucessfully.")},onClearFilters:function(){this.byId("tblContracts").getBinding("rows").filter([]);o.show("Filters cleared Sucessfully.")},onExportData:function(e){let t=this.byId("tblContracts");let r=t.getBinding("rows");let o=this.createColumnConfig();let s={workbook:{columns:o,hierarchyLevel:"Level"},dataSource:r,fileName:"Contracts.xlsx",worker:false};let n=new c(s);n.build().finally(function(){n.destroy()})},createColumnConfig:function(){var e=[];e.push({label:"ID",property:"ID",type:p.String});e.push({label:"Contract Name",property:"alias",type:p.String});e.push({label:"Contract ID",property:"contract_id",type:p.String});e.push({label:"Description",property:"description",type:p.String});e.push({label:"Contract Type",property:"templates/name",type:p.String});e.push({label:"Start Date",property:"start_date",type:p.DateTime});e.push({label:"End Date",property:"end_date",type:p.DateTime});return e},_refreshTable:function(){this.byId("tblContracts").getBinding("rows").refresh()},onClearFilters:function(){this.byId("clearFilters").setEnabled(false);this.clearAllFilters()},clearAllFilters:function(){var e=this.byId("tblContracts");var t=null;var r=e.getColumns();for(var o=0;o<r.length;o++){e.filter(r[o],null)}this.byId("tblContracts").getBinding("rows").filter(t,"Application");this.byId("tblContracts").getBinding("rows").filter([])},onTableFilter:function(e){var t=e.getParameter("value");var r=this.byId("tblContracts");var o=r.getBinding("rows");if(t){this.byId("clearFilters").setEnabled(true);var s=r.getColumns();var a=[];s.forEach(function(e){var r=e.getFilterProperty();if(r){var o=new n({path:r,operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});a.push(o)}});var l=new sap.ui.model.Filter({filters:a,and:false});o.filter(l,sap.ui.model.FilterType.Application);e.preventDefault()}else{this.byId("clearFilters").setEnabled(false);o.filter([],sap.ui.model.FilterType.Application)}},_setPersonalization:function(){var e,t,r={oPersoData:{_persoSchemaVersion:"1.0",aColumns:[]},getPersData:function(){t=new jQuery.Deferred;if(!this._oBundle){this._oBundle=this.oPersoData}e=this._oBundle;t.resolve(e);return t.promise()},setPersData:function(e){t=new jQuery.Deferred;this._oBundle=e;t.resolve();return t.promise()},delPersData:function(){t=new jQuery.Deferred;t.resolve();return t.promise()}};this.oTablePersoController=new s({table:this.byId("tblContracts"),persoService:r})},onPersonalization:function(){this.oTablePersoController.openDialog()},onRowsUpdated:function(){var e=this.byId("tblContracts");this.getModel("appModel").setProperty("/ContractCount",e.getBinding("rows").getLength())},onCreateContract:function(e){var e;if(e){this.getRouter().navTo(e)}else{console.error("Navigation target not defined.")}},onDeleteContract:function(e){const t=this.getView();const s=e.getSource();const n=s.getBindingContext();if(!n){sap.m.MessageToast.show("No contract selected for delete.");return}const a=n.getProperty("alias")||n.getProperty("contract_id")||"this contract";const l=`Are you sure you want to delete ${a}?`;r.confirm(l,{title:"Confirm delete",onClose:e=>{if(e!==sap.m.MessageBox.Action.OK){return}t.setBusy(true);n.delete().then(()=>{t.setBusy(false);o.show("Contract deleted");const e=t.getModel();try{e.refresh(true)}catch(e){}}).catch(e=>{t.setBusy(false);const o=e&&e.message?e.message:"Delete failed";r.error("Failed to delete contract: "+o);try{t.getModel().refresh(true)}catch(e){}})}})},onEditContract:function(e){let t=e.getSource().getBindingContext();let{ID:r}=t.getObject();this.getRouter().navTo("ContractDetails",{contractId:r})}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.predefine("com/dhi/cms/cmsrequester/util/DetailsFactory", ["sap/ui/base/Object","sap/m/VBox","sap/m/Label","sap/m/Input","sap/m/CheckBox","sap/m/DatePicker","sap/m/ComboBox","sap/ui/core/Item","sap/ui/core/ListItem"],function(e,t,a,l,i,r,s,d,u){"use strict";var o=e.extend("com.dhi.cms.util.DetailsFactory",{});o.renderDetailsControls=function(e,d){var o=d.getObject();var p=d.getModel("Details");o=o||{};o.AttributeType=o.AttributeType||"String";o.AttributeValue=o.AttributeValue||"";o.Value=o.Value;var n=(o.Attribute_Name||"attr").replace(/\s+/g,"_").replace(/[^\w\-]/g,"");var b=e+"-"+(o.Attribute_ID||n);var c=new a({required:!!o.IsMandatory,text:o.Attribute_Name||"Attribute",showColon:true});c.addStyleClass("sapUiTinyMarginBottom");var m=null;var y="350px";switch((o.AttributeType||"").toLowerCase()){case"text":case"string":m=new l(b,{type:"Text",editable:"{appModel>/isFieldEditable}"});m.bindProperty("value",{path:"Value",model:"Details"});break;case"number":case"integer":m=new l(b,{type:"Number",editable:"{appModel>/isFieldEditable}"});m.bindProperty("value",{path:"Value",model:"Details"});break;case"date":if(o.Value===""){o.Value=null}m=new r(b,{width:y,editable:"{appModel>/isFieldEditable}"});m.bindProperty("dateValue",{path:"Value",model:"Details"});break;case"boolean":if(o.Value==="true"){o.Value=true}else if(o.Value==="false"){o.Value=false}else{o.Value=null}m=new i(b,{editable:"{appModel>/isFieldEditable}"});m.bindProperty("selected",{path:"Value",model:"Details"});break;case"select":var V=o.AttributeTypeAssociation||[];d.getModel("ComboBoxModel").setProperty("/AttributeSelection"+b,V);m=new s(b,{width:y,showSecondaryValues:true,selectedKey:"{Details>Value}",editable:"{appModel>/isFieldEditable}"});var D=new u({key:"{Details>ID}",text:"{Details>value}"});m.bindItems({path:"Details>/AttributeSelection"+b,template:D,templateShareable:true});break;default:m=new l(b,{type:"Text",editable:"{appModel>/isFieldEditable}"});m.bindProperty("value",{path:"Value",model:"Details"});break}if(m&&!m.getModel("Details")){m.setModel(p,"Details")}var w=new t({width:y,items:[c,m]});w.addStyleClass("sapUiTinyMargin");w.setBindingContext(d,"Details");return w};return o});
sap.ui.predefine("com/dhi/cms/cmsrequester/util/transaction/ContractHandler", ["sap/ui/base/Object"],function(t){"use strict";return t.extend("com.dhi.cms.cmsrequester.util.transaction.ContractHandler",{constructor:function(t){this.batchId="contracts";this.model=null;this.entityName="Contracts";this.associations={attribute_values:"attribute_values",attachments:"attachments",templates:"templates"};this.isBound=false;this.activeContext=null;this.mandatoryFields=[];this.attributeDataFetchedMap={}},initializeBinding:function(t,e){this.controller=e;this.model=t;this.contractBinding=this.model.bindList(`/${this.entityName}`,null,[],[],{$expand:"templates,attribute_values,attachments",$$updateGroupId:this.batchId});this.isBound=true},resetAttributeFetchState:function(){this.attributeDataFetchedMap={};this.attributeValues=null;this.resetContractAttributes=true},createNewContract:function(t){this.model.resetChanges(this.batchId);this.createContext=this.contractBinding.create(Object.assign({alias:"",contract_id:"",name:"",description:"",start_date:null,end_date:null,status:"Draft",templates_ID:null},t||{}),{$$updateGroupId:this.batchId});this.activeContext=this.createContext;this.attributeValues=this.model.bindList(`${this.associations.attribute_values}`,this.activeContext,[],[],{$$updateGroupId:this.batchId});this.assetBinding=this.model.bindList(`${this.associations.attachments}`,this.activeContext,[],[],{$$updateGroupId:this.batchId});return this.createContext},getExistingContract:function(t){return new Promise((e,i)=>{let s=this.getContractContext(t);if(!s){return i(new Error("Context not found"))}if(s.isTransient&&s.isTransient()){return i(new Error("Context is transient/unready"))}s.requestObject().then(()=>{this.activeContext=s;this._ensureAssociationBindings();e(s)}).catch(i)})},_ensureAssociationBindings:function(){if(!this.attributeValues||this.attributeValues.getContext()!==this.activeContext){this.attributeValues=this.model.bindList(`${this.associations.attribute_values}`,this.activeContext,[],[],{$$updateGroupId:this.batchId})}if(!this.assetBinding||this.assetBinding.getContext()!==this.activeContext){this.assetBinding=this.model.bindList(`${this.associations.attachments}`,this.activeContext,[],[],{$$updateGroupId:this.batchId})}},getContractContext:function(t){const e=`/Contracts(${t})`;const i=this.model.bindContext(e,{$$ownRequest:true});return i.getBoundContext()},getActiveContext:function(){this._ensureAssociationBindings();return this.activeContext},getContractAttributes:function(){this.getActiveContext();const t=this.activeContext.getProperty("ID");return new Promise((e,i)=>{if(this.attributeDataFetchedMap[t]&&!this.resetContractAttributes){const t=this.attributeValues.getContexts();e(t.map(t=>t.getObject()))}else{this.attributeValues.getContexts(0,200);this.attributeValues.attachEventOnce("dataReceived",()=>{const i=this.attributeValues.getContexts();this.attributeDataFetchedMap[t]=true;this.resetContractAttributes=false;e(i.map(t=>t.getObject()))})}})},createAttribute:function({attribute_groups_ID:t,attributes_ID:e,value:i}){this.getActiveContext();this.attributeValues.create({attribute_groups_ID:t,attributes_ID:e,valueJson:this._formattedJsonValue(i)})},updateAttribute:function(t,e){return new Promise((i,s)=>{const{ID:n,contracts_ID:a,attribute_groups_ID:r,attributes_ID:o}=t;const u=this.model.getKeyPredicate("/ContractsAttributes",{ID:n,contracts_ID:a,attribute_groups_ID:r,attributes_ID:o});const c=`/ContractsAttributes`+u;const h=this.model.bindContext(c,{$$ownRequest:true});const d=h.getBoundContext();d.requestObject().then(()=>{d.setProperty("valueJson",this._formattedJsonValue(e));i()}).catch(s)})},_formattedJsonValue:function(t){const e={value:t===null?"null":t};const i=JSON.stringify(e);return i.replace(/"/g,'\\"')},save:function(){return this.model.submitBatch(this.batchId)},deleteContract:function(t){return new Promise((e,i)=>{const s=this.getContractContext(t);s.requestObject().then(()=>{s.delete().then(e).catch(i)}).catch(i)})}})});
sap.ui.predefine("com/dhi/cms/cmsrequester/util/transaction/ContractManager", ["sap/ui/base/Object","com/dhi/cms/cmsrequester/util/transaction/ContractHandler"],function(e,t){"use strict";var n=null;var t=e.extend("com.dhi.cms.cmsrequester.util.transaction.ContractHandler",{constructor:function(){if(n){throw new Error("Error: Instantiation failed. Use getInstance() instead of new.")}n=this}});t.model=null;t.getInstance=function(){if(!n){n=new t}if(n.model&&n.model.getId()!==t.model.getId()){n.model.resetChanges(n.batchId);n.model=t.model;n.isBound=false}return n};t.updateModel=function(e){t.model=e};return t});
sap.ui.require.preload({
	"com/dhi/cms/cmsrequester/fragments/Attachments.fragment.xml":'<core:FragmentDefinition xmlns:plugins="sap.m.plugins"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:u="sap.ui.unified"\n    xmlns:f="sap.f"\n    xmlns:grid="sap.ui.layout.cssgrid"\n    xmlns:upload="sap.m.upload"><f:GridList class="sapUiMediumMarginTop sapUiMediumMarginBegin" width="96%"><f:GridListItem><Table id ="UploadSetTable" sticky ="ColumnHeaders,HeaderToolbar" width ="auto" mode ="MultiSelect" fixedLayout ="false" inset ="true" autoPopinMode ="true" hiddenInPopin ="None" items ="{ path : \'contractModel>/attachments\'}" selectionChange ="onSelectionChange"><headerToolbar><OverflowToolbar><Title text="Uploaded ({= ${/Attachments/$count}})" level="H2" /><ToolbarSpacer /><SearchField width="20%" liveChange=".onSearchDocuments"><layoutData><OverflowToolbarLayoutData priority="NeverOverflow" /></layoutData></SearchField><ToolbarSeparator class="sapUiSmallMarginBeginEnd" /><upload:ActionsPlaceholder id="uploadButton" placeholderFor="UploadButtonPlaceholder" /><Button id="downloadSelectedButton" text="Download" enabled="false" press="onDownloadFiles" /></OverflowToolbar></headerToolbar><dependents><plugins:UploadSetwithTable multiple="true" beforeInitiatingItemUpload="onBeforeInitiatingItemUpload" beforeUploadStarts="onBeforeUploadStarts"  itemRenamed="onDocumentRenamedSuccess" uploadCompleted="onUploadCompleted" onActivated="onPluginActivated" cloudFilePickerEnabled="true" actions="uploadButton" fileTypes= "{appModel>/validAssetTypes}"><plugins:rowConfiguration><upload:UploadItemConfiguration fileNamePath="file_name" mediaTypePath="media_type" urlPath="file_url" previewablePath="previewable" isTrustedSourcePath="trustedSource" ></upload:UploadItemConfiguration></plugins:rowConfiguration></plugins:UploadSetwithTable></dependents><columns><Column id="fileName" importance="High"><header><Label text="File Name" /></header></Column><Column id="FileSize"><header><Label text="File Size" /></header></Column><Column id="fileType"><header><Label text="File Type" /></header></Column><Column id="uploadedOn" visible="{= %{contractModel>/ID}? true:false}"><header><Label text="Uploaded On" /></header></Column><Column id="Action"><header><Label text="Action" /></header></Column></columns><items><ColumnListItem><cells><Link text="{contractModel>file_name}" press="openPreview" class="sapUiTinyMarginBottom"/><Text text="{contractModel>file_size} KB" /><Text text="{contractModel>media_type}" /><Text text="{contractModel>modifiedAt}" visible="{= %{contractModel>/ID}? true:false}"/><Button class="sapUiTinyMarginBegin" type="Transparent" icon="sap-icon://decline" press="onRemoveFiles" /></cells></ColumnListItem></items></Table></f:GridListItem></f:GridList></core:FragmentDefinition>',
	"com/dhi/cms/cmsrequester/fragments/BasicInformation.fragment.xml":'<core:FragmentDefinition xmlns:f="sap.ui.layout.form" xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:grid="sap.ui.layout.cssgrid"><f:SimpleForm\n      id="contractSimpleForm"\n            editable="true"\n            title="Contract Information"\n            width="98%"\n            maxContainerCols="1"\n            layout="ResponsiveGridLayout"\n            labelSpanL="4" labelSpanM="4" labelSpanS="12"\n            adjustLabelSpan="true"\n            columnsL="1"\n            columnsM="1"\n            columnsXL="1"\n            class="contractForm"\n       \n    ><f:content><Label text="Contract Title" required="true"/><Input \n                id="contractTitleInput" \n                placeholder="Enter contract title" \n                value="{contractModel>/name}"\n                width="500px" \n                required="true"\n            /><Label text="Contract Number / Reference ID" visible="{= !!${contractModel>/ID} }"/><Input \n                id="contractNumberInput" \n                placeholder="Enter contract ID" \n                value="{contractModel>/ID}" \n                editable="false"\n                width="500px"\n                visible="{= !!${contractModel>/ID} }"\n            /><Label text="Contract Type" required="true"/><ComboBox \n                id="contractTypeSelect" \n                placeholder="Please select"\n                selectedKey="{contractModel>/templates_ID}" \n                items="{path: \'/Templates\'}"\n                width="500px"\n                editable="{= !${contractModel>/ID} }"\n                required="true"\n            ><core:Item key="{ID}" text="{name}" /></ComboBox><Label text="Alias" required="true"/><Input \n                id="contractaliasInput" \n                placeholder="Enter contract title" \n                value="{contractModel>/alias}"\n                width="500px" \n                required="true"\n            /><Label text="Description" required="true"/><Input \n                id="contractdescriptionInput" \n                placeholder="Enter contract title" \n                value="{contractModel>/description}"\n                width="500px" \n                required="true"\n            /><Label text="Related Master Agreement"/><Input \n                id="masterAgreementInput" \n                placeholder="Enter reference ID" \n                value="{contractModel>/MasterAgreementID}"\n                width="500px"\n            /><Label text="Start Date"></Label><DatePicker                 width="500px"\n></DatePicker><Label text="Expiry Date"></Label><DatePicker                 width="500px"\n ></DatePicker></f:content></f:SimpleForm></core:FragmentDefinition>',
	"com/dhi/cms/cmsrequester/fragments/BusyDialog.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><BusyDialog title="One Moment"/></core:FragmentDefinition>',
	"com/dhi/cms/cmsrequester/fragments/Details.fragment.xml":'\n<core:FragmentDefinition xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:f="sap.f"><IconTabBar id="idSpecificationBox" items="{Details>/AttributeGroups}" expandable="false"  headerBackgroundDesign="Solid"><items><IconTabFilter key="{Details>Attribute_Groups_ID}" text="{= ${Details>Attribute_Group_Name}.toUpperCase() }" ><f:GridList class="sapUiMediumMarginTop sapUiMediumMarginBegin" width="96%"><f:GridListItem><HBox class="sapUiLargeMargin" core:require=\'{ handler : "com/dhi/cms/cmsrequester/util/DetailsFactory" }\'><HBox items="{ path: \'Details>Attributes\', factory: \'handler.renderDetailsControls\' }" wrap="Wrap"/></HBox></f:GridListItem></f:GridList></IconTabFilter></items></IconTabBar></core:FragmentDefinition>\n',
	"com/dhi/cms/cmsrequester/fragments/Preview.fragment.xml":'<core:FragmentDefinition   xmlns="sap.m"\n  xmlns:core="sap.ui.core"\n  xmlns:f="sap.ui.layout.form"\n  xmlns:layout="sap.ui.layout"><ScrollContainer height="80vh" width="100%" vertical="true" horizontal="false"><VBox class="previewDialogVBox" width="100%" renderType="Bare"><Panel headerText="Basic Information" expandable="false" class="previewPanel"><f:SimpleForm\n              layout="ResponsiveGridLayout"\n              editable="false"\n              class="previewForm"\n              labelSpanL="4" labelSpanM="4" labelSpanS="12"\n              adjustLabelSpan="true"\n              maxContainerCols="1"\n              columnsXL="1" columnsL="1" columnsM="1"><Label text="Contract Title"/><Text text="{contractModel>/name}" /><Label text="Contract Number / Reference ID"/><Text text="{contractModel>/contract_id}" /><Label text="Start Date"/><Text text="{parts: [{path: \'contractModel>/start_date\'}], formatter: \'.formatDate\'}" /><Label text="End Date"/><Text text="{parts: [{path: \'contractModel>/end_date\'}], formatter: \'.formatDate\'}" /><Label text="Status"/><Text text="{contractModel>/status}" /><Label text="Contract Type (Template ID)"/><Text text="{contractModel>/templates_ID}" /></f:SimpleForm></Panel><List\n            items="{Details>/AttributeGroups}"\n            showSeparators="None"\n            width="100%"\n            class="attributeGroupList"\n            noDataText="No attribute groups found"><items><CustomListItem type="Inactive"><Panel headerText="{Details>Attribute_Group_Name}" expandable="false" width="100%" class="attributeGroupPanel"><VBox width="100%"><List items="{Details>Attributes}" width="100%" showSeparators="None"><items><CustomListItem type="Inactive"><HBox fitContainer="true" width="100%" justifyContent="SpaceAround"><VBox width="45%" alignItems="End"><Label text="{Details>Attribute_Name}" showColon="true" wrapping="false" class="attributeLabel"/></VBox><VBox width="55%" justifyContent="Start"><Text\n                                  text="{parts: [{ path: \'Details>Value\' }, { path: \'Details>AttributeType\' }], formatter: \'.formatAttribute\'}"\n                                  wrapping="true"\n                                  class="attributeValue"/></VBox></HBox></CustomListItem></items></List></VBox></Panel></CustomListItem></items></List></VBox></ScrollContainer></core:FragmentDefinition>\n',
	"com/dhi/cms/cmsrequester/i18n/i18n.properties":'# This is the resource bundle for com.dhi.cms.cmsrequester\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Contracts Management\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Contracts Management\n\n#XFLD,57\nCMS-Display.flpTitle=Contract Management\n',
	"com/dhi/cms/cmsrequester/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"com.dhi.cms.cmsrequester","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.19.6","toolsId":"b103316d-3bcc-4d5b-be45-3cf43f2ed175"},"dataSources":{"mainService":{"uri":"/contracts/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"CMS-Display":{"semanticObject":"CMS","action":"Display","title":"{{CMS-Display.flpTitle}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":false,"dependencies":{"minUI5Version":"1.143.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"com.dhi.cms.cmsrequester.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"contractModel":{"type":"sap.ui.model.json.JSONModel","uri":"model/contract.json"},"Details":{"type":"sap.ui.model.json.JSONModel","uri":"model/details.json"},"appModel":{"type":"sap.ui.model.json.JSONModel"},"ComboBoxModel":{"type":"sap.ui.model.json.JSONModel"}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"com.dhi.cms.cmsrequester.view","async":true,"viewPath":"com.dhi.cms.cmsrequester.view"},"routes":[{"name":"Contracts","pattern":":?query:","target":["TargetContracts"]},{"name":"ContractDetails","pattern":"ContractDetails/:contractId:","target":["TargetContractDetails"]}],"targets":{"TargetContracts":{"id":"Contracts","name":"Contracts"},"TargetContractDetails":{"id":"ContractDetails","name":"ContractDetails"}}},"rootView":{"viewName":"com.dhi.cms.cmsrequester.view.App","type":"XML","id":"App","async":true},"flexBundle":false},"sap.cloud":{"public":true,"service":"cms"}}',
	"com/dhi/cms/cmsrequester/view/App.view.xml":'<mvc:View controllerName="com.dhi.cms.cmsrequester.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"com/dhi/cms/cmsrequester/view/ContractDetails.view.xml":'<mvc:View controllerName="com.dhi.cms.cmsrequester.controller.ContractDetails"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"\n    xmlns:l="sap.ui.layout"><Page id="createProductsPage" showHeader="false"><content><IconTabBar id="iconTabBar" class="noBottomLine" expandable="false" backgroundDesign="Transparent" headerMode="Inline" selectedKey="BasicInfo" select="onTabSelect"><items><IconTabFilter key="BasicInfo" text="Basic_Information"><OverflowToolbar class="customToolbar" design="Transparent" height="3rem"><ToolbarSpacer/><Button text="Next" type="Emphasized" icon="sap-icon://open-command-field" press=".handleNextTabpress(\'Details\')"/><Button class="sapUiTinyMarginBegin" text="Cancel" icon="sap-icon://decline" press="onNavigation(\'Contracts\')" visible="{appModel>/isButtonVisible}"/></OverflowToolbar><core:Fragment class="sapUiSmallMargin" fragmentName="com.dhi.cms.cmsrequester.fragments.BasicInformation" type="XML" /></IconTabFilter><IconTabFilter key="Details" text="Details"><OverflowToolbar class="customToolbar" design="Transparent" height="3rem"><ToolbarSpacer/><Button text="Next" type="Emphasized" icon="sap-icon://open-command-field" press=".handleNextTabpress(\'Attachments\')"/><Button class="sapUiTinyMarginBegin" text="Cancel" icon="sap-icon://decline" press="onNavigation(\'Contracts\')"/></OverflowToolbar><core:Fragment class="sapUiSmallMarginEnd" fragmentName="com.dhi.cms.cmsrequester.fragments.Details" type="XML" /></IconTabFilter><IconTabFilter key="Attachments" text="Attachments"><OverflowToolbar class="customToolbar" design="Transparent" height="3rem"><ToolbarSpacer/><Button text="Next" type="Emphasized" icon="sap-icon://open-command-field" press=".handleNextTabpress(\'ContractPrev\')"/><Button class="sapUiTinyMarginBegin" text="Cancel" icon="sap-icon://decline" press="onNavigation(\'Contracts\')"/></OverflowToolbar><core:Fragment fragmentName="com.dhi.cms.cmsrequester.fragments.Attachments" type="XML" /></IconTabFilter><IconTabFilter key="ContractPrev" text="Contract Preview" visible="{= ${appModel>/isProductPreviewVisible} &amp;&amp; (${appModel>/userRole} === \'admin\' || ${appModel>/userRole} === \'catManager\')}"><OverflowToolbar class="customToolbar" design="Transparent" height="3rem"><ToolbarSpacer/><Button text="Submit" type="Emphasized" icon="sap-icon://save" press="handleSaveandSubmitContractDetails(\'submit\')" /><Button text="Save as Draft" type="Emphasized" icon="sap-icon://notes" press="handleSaveandSubmitContractDetails(\'save\')" /><Button class="sapUiTinyMarginBegin" text="Cancel" icon="sap-icon://decline" press="onNavigation(\'Contracts\')"/></OverflowToolbar><core:Fragment fragmentName="com.dhi.cms.cmsrequester.fragments.Preview" type="XML" /></IconTabFilter></items></IconTabBar></content></Page></mvc:View>',
	"com/dhi/cms/cmsrequester/view/Contracts.view.xml":'<mvc:View xmlns:filterbar="sap.ui.comp.filterbar"\n    xmlns:f="sap.f" \n    controllerName="com.dhi.cms.cmsrequester.controller.Contracts"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:table="sap.ui.table"\n    xmlns:columnmenu="sap.m.table.columnmenu"><f:DynamicPage id="productsPage" headerExpanded="true"><f:title><f:DynamicPageTitle><f:heading><Title text="Contracts Management"></Title></f:heading></f:DynamicPageTitle></f:title><f:header><f:DynamicPageHeader><filterbar:FilterBar id="idFilterBar" useToolbar="false" search=".onGoBtnPress"><filterbar:filterGroupItems><filterbar:FilterGroupItem label="Contract ID" name="contract_id" groupName="group1" visibleInFilterBar="true"><filterbar:control><Input placeholder="Please Enter contract ID"></Input></filterbar:control></filterbar:FilterGroupItem><filterbar:FilterGroupItem label="Contract Type" name="templates/name" groupName="group1" visibleInFilterBar="true"><filterbar:control><MultiComboBox items="{/Templates}"><core:Item key="{name}" text="{name}" /></MultiComboBox></filterbar:control></filterbar:FilterGroupItem></filterbar:filterGroupItems></filterbar:FilterBar></f:DynamicPageHeader></f:header><f:content><table:Table id="tblContracts" alternateRowColors="true" selectionMode="None" rows="{ path: \'/Contracts\',\n            parameters: { operationMode: \'Server\', $select: \'ID,alias,contract_id,description,start_date,end_date,templates_ID\' },\n            sorter: { path: \'modifiedAt\', descending: true } }"  enableColumnFreeze="true" enableCellFilter="true" filter="onTableFilter" rowsUpdated="onRowsUpdated" enableBusyIndicator="true"><table:extension><OverflowToolbar class="sapUiTinyMarginTop overflowToolbarBorder"><Title text="Contracts({appModel>/ContractCount})"/><ToolbarSpacer/><Button id="createContract" text="Create Contract" icon="sap-icon://add-document" press="onCreateContract(\'ContractDetails\')" type="Emphasized"/><Button id="clearFilters" visible="true" text="Clear Filters" icon="sap-icon://clear-filter" press="onClearFilters"/><Button icon="sap-icon://action-settings" press="onPersonalization" /><Button id="exportContracts" press=".onExportData" icon="sap-icon://excel-attachment" /></OverflowToolbar></table:extension><table:columns ><table:Column id="col_id" sortProperty="ID" filterProperty="ID" ><Label text="ID" wrapping="true"/><table:template><Text text="{ID}"/></table:template></table:Column><table:Column id="col_alias" sortProperty="alias" filterProperty="alias" width="10rem"><Label text="Contract Name" wrapping="true"/><table:template><Text text="{alias}" wrapping="true"/></table:template></table:Column><table:Column id="col_description" sortProperty="description" filterProperty="description" width="12rem"><Label text="Description"/><table:template><Text text="{description}" wrapping="true"/></table:template></table:Column><table:Column id="col_templates_id" sortProperty="templates/name" filterProperty="templates/name" width="8rem"><Label text="Contract Type"/><table:template><Text text="{templates/name}" wrapping="true"/></table:template></table:Column><table:Column id="col_start_date" sortProperty="start_date" filterProperty="start_date" width="9rem"><Label text="Start Date"/><table:template><Text text="{parts: [{path: \'start_date\'}], formatter: \'.formatter.formatDate\'}" /></table:template></table:Column><table:Column id="col_end_date" sortProperty="end_date" filterProperty="end_date" width="9rem"><Label text="End Date"/><table:template><Text text="{parts: [{path: \'end_date\'}], formatter: \'.formatter.formatDate\'}" /></table:template></table:Column><table:Column id="col_status" sortProperty="status" filterProperty="status" width="7rem"><Label text="Status"/><table:template><Text text="{status}" /></table:template></table:Column><table:Column id="col_actions" width="7rem"><Label text="Actions" /><table:template><HBox gap="5px" alignItems="Center" justifyContent="Center"><Button icon="sap-icon://show" type="Emphasized" press=".onViewContract" tooltip="View" visible="{= %{status}.toLowerCase() === \'draft\' ? false : true }" /><Button icon="sap-icon://edit" type="Success" press=".onEditContract" tooltip="Edit" visible="{= %{status}.toLowerCase()===\'draft\'? true : false}" /><Button icon="sap-icon://delete" type="Reject" press=".onDeleteContract" tooltip="Delete"/></HBox></table:template></table:Column></table:columns></table:Table></f:content></f:DynamicPage></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
